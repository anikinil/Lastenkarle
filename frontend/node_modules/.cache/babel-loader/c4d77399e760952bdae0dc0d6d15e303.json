{"ast":null,"code":"var _jsxFileName = \"/home/ilja/Lastenkarle/buchungssytem-lastenkarle/frontend/src/features/enrollment/pages/Enrollment.js\";\nimport React, { useState, startTransition } from 'react';\nimport { useTranslation } from 'react-i18next';\nimport { useNavigate } from 'react-router-dom';\nconst stores = [{\n  id: 1,\n  value: 'Store 1'\n}, {\n  id: 2,\n  value: 'Store 2'\n}, {\n  id: 3,\n  value: 'Store 3'\n}, {\n  id: 4,\n  value: 'Store 4'\n}];\nconst Enrollment = () => {\n  const {\n    t\n  } = useTranslation();\n  const navigate = useNavigate();\n  const [username, setUsername] = useState();\n  const [email, setEmail] = useState();\n  const [stores, setStores] = useState([]);\n  const [selectedRole, setSelectedRole] = useState({});\n\n  // TODO token acquisition from cookie\n  const [token, setToken] = useState();\n\n  // NOTE when fetching implemented\n  // const fetchStores= () => {\n  //     // TODO proper URI variable\n  //     fetch('URI_ADMIN_STORES', {\n  //         headers: {\n  //             'Content-Type': 'application/json',\n  //             'Authorization': `Token ${token}`\n  //         },\n  //     })\n  //         .then(response => {\n  //             return response.json()\n  //         })\n  //         .then(data => {\n  //             setStores(data)\n  //         })\n  // }\n  // useEffect(() => {\n  //     fetchStores();\n  // }, [])\n\n  const roleOptions = [...stores.map(store => ({\n    value: t('store') + ': ' + store.name,\n    label: 'Manager: ' + store.name\n  })), {\n    value: t('administrator'),\n    label: 'admin'\n  }];\n  const postEnrollment = () => {\n    let payload = {\n      contact_data: email,\n      user_status: selectedRole\n    };\n\n    // POST enrollment request\n    // TODO proper URI variable\n    fetch('URI_ADMIN_ENROLL', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Token ${token}`\n      },\n      body: JSON.stringify(payload)\n    }).then(response => {\n      if (response) {\n        alert(t('enrollment_successful'));\n      } else {\n        return response.json().then(errorText => {\n          throw new Error(errorText.detail);\n        });\n      }\n    }).catch(error => {\n      // TODO proper error handling\n      // TODO proper error variable\n      alert('ERR_POSTING_ENROLLMENT' + ' ' + error.message);\n    });\n  };\n  const handleRoleChange = selectedRoleOption => {\n    setSelectedRole(selectedRoleOption.value);\n  };\n\n  // this prevents user from switching to new line by hitting [Enter]\n  const handleFieldKeyDown = event => {\n    if (event.key === 'Enter') {\n      event.preventDefault();\n    }\n  };\n  const handleEnrollClick = () => {\n    postEnrollment();\n    // TODO notify on success/failure perhaps via alert (in this line)\n    // TODO add proper variable\n    navigate('/home');\n  };\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 13\n    }\n  }, t('enrollment')), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }\n  }, t('enter_one_of_the_following_to_identify_user')), /*#__PURE__*/React.createElement(\"textarea\", {\n    title: t('enter_username'),\n    className: \"username\",\n    rows: \"1\",\n    value: username,\n    onChange: e => setUsername(e.target.value),\n    onKeyDown: handleFieldKeyDown,\n    placeholder: t('enter_username'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"textarea\", {\n    title: t('enter_email'),\n    className: \"email\",\n    rows: \"1\",\n    value: email,\n    onChange: e => setEmail(e.target.value),\n    onKeyDown: handleFieldKeyDown,\n    placeholder: t('enter_email'),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, t('select_role')), /*#__PURE__*/React.createElement(\"select\", {\n    title: \"roles\",\n    className: \"select\",\n    onChange: handleRoleChange,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 13\n    }\n  }, roleOptions.map(e => /*#__PURE__*/React.createElement(\"option\", {\n    key: e.key,\n    value: e.key,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 39\n    }\n  }, e.value)), \";\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"button-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    type: \"button\",\n    className: \"button accent\",\n    onClick: handleEnrollClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 17\n    }\n  }, t('enroll'))));\n};\nexport default Enrollment;","map":{"version":3,"names":["React","useState","startTransition","useTranslation","useNavigate","stores","id","value","Enrollment","t","navigate","username","setUsername","email","setEmail","setStores","selectedRole","setSelectedRole","token","setToken","roleOptions","map","store","name","label","postEnrollment","payload","contact_data","user_status","fetch","method","headers","body","JSON","stringify","then","response","alert","json","errorText","Error","detail","catch","error","message","handleRoleChange","selectedRoleOption","handleFieldKeyDown","event","key","preventDefault","handleEnrollClick","createElement","Fragment","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","title","className","rows","onChange","e","target","onKeyDown","placeholder","type","onClick"],"sources":["/home/ilja/Lastenkarle/buchungssytem-lastenkarle/frontend/src/features/enrollment/pages/Enrollment.js"],"sourcesContent":["import React, { useState, startTransition } from 'react';\nimport { useTranslation } from 'react-i18next';\n\nimport { useNavigate } from 'react-router-dom';\n\nconst stores = [\n    { id: 1, value: 'Store 1' },\n    { id: 2, value: 'Store 2' },\n    { id: 3, value: 'Store 3' },\n    { id: 4, value: 'Store 4' }\n]\n\nconst Enrollment = () => {\n\n    const { t } = useTranslation();\n\n    const navigate = useNavigate();\n\n    const [username, setUsername] = useState();\n    const [email, setEmail] = useState();\n\n    const [stores, setStores] = useState([]);\n    const [selectedRole, setSelectedRole] = useState({});\n\n    // TODO token acquisition from cookie\n    const [token, setToken] = useState()\n\n    // NOTE when fetching implemented\n    // const fetchStores= () => {\n    //     // TODO proper URI variable\n    //     fetch('URI_ADMIN_STORES', {\n    //         headers: {\n    //             'Content-Type': 'application/json',\n    //             'Authorization': `Token ${token}`\n    //         },\n    //     })\n    //         .then(response => {\n    //             return response.json()\n    //         })\n    //         .then(data => {\n    //             setStores(data)\n    //         })\n    // }\n    // useEffect(() => {\n    //     fetchStores();\n    // }, [])\n\n    \n    const roleOptions = [...stores.map((store) => (\n        { value: t('store') + ': ' + store.name, label: 'Manager: ' + store.name }\n    )), { value: t('administrator'), label: 'admin' }];\n\n    const postEnrollment = () => {\n\n        let payload = {\n            contact_data: email,\n            user_status: selectedRole\n        };\n\n        // POST enrollment request\n        // TODO proper URI variable\n        fetch('URI_ADMIN_ENROLL', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Token ${token}`\n            },\n            body: JSON.stringify(payload)\n        })\n            .then(response => {\n                if (response) {\n                    alert(t('enrollment_successful'));\n                }\n                else {\n                    return response.json().then((errorText) => {\n                        throw new Error(errorText.detail);\n                    });\n                }\n            })\n            .catch(error => {\n                // TODO proper error handling\n                // TODO proper error variable\n                alert('ERR_POSTING_ENROLLMENT' + ' ' + error.message);\n            })\n    }\n\n    const handleRoleChange = (selectedRoleOption) => {\n        setSelectedRole(selectedRoleOption.value)\n    }\n\n    // this prevents user from switching to new line by hitting [Enter]\n    const handleFieldKeyDown = (event) => {\n        if (event.key === 'Enter') {\n            event.preventDefault();\n        }\n    };\n\n    const handleEnrollClick = () => {\n        postEnrollment()\n        // TODO notify on success/failure perhaps via alert (in this line)\n        // TODO add proper variable\n        navigate('/home')\n    }\n\n    return (\n        <>\n            <h1>{t('enrollment')}</h1>\n\n            <p>{t('enter_one_of_the_following_to_identify_user')}</p>\n\n            <textarea\n                title={t('enter_username')}\n                className='username'\n                rows='1'\n                value={username}\n                onChange={e => setUsername(e.target.value)}\n                onKeyDown={handleFieldKeyDown}\n                placeholder={t('enter_username')}\n            >\n            </textarea>\n\n            <textarea\n                title={t('enter_email')}\n                className='email'\n                rows='1'\n                value={email}\n                onChange={e => setEmail(e.target.value)}\n                onKeyDown={handleFieldKeyDown}\n                placeholder={t('enter_email')}\n            >\n            </textarea>\n\n            {/* TODO style */}\n\n            <p>{t('select_role')}</p>\n            <select title='roles' className='select' onChange={handleRoleChange}>\n                {roleOptions.map(e => <option key={e.key} value={e.key}>{e.value}</option>)};\n            </select>\n            \n            <div className='button-container'>\n                <button type='button' className='button accent' onClick={handleEnrollClick}>{t('enroll')}</button>\n            </div>\n        </>\n    );\n};\n\nexport default Enrollment;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}